class l{constructor(){this.cartKey="laravelpizza_cart",this.cart=this.getCartFromStorage(),this.updateCartDisplay()}getCartFromStorage(){const e=localStorage.getItem(this.cartKey);return e?JSON.parse(e):[]}saveCartToStorage(){localStorage.setItem(this.cartKey,JSON.stringify(this.cart))}addItem(e,t,r=0){const a=this.cart.find(o=>o.id===e);a?a.quantity+=1:this.cart.push({id:e,name:t,price:r,quantity:1}),this.saveCartToStorage(),this.updateCartDisplay(),this.announceToScreenReader(`${t} aggiunta al carrello`)}removeItem(e){this.cart=this.cart.filter(t=>t.id!==e),this.saveCartToStorage(),this.updateCartDisplay()}updateQuantity(e,t){const r=this.cart.find(a=>a.id===e);r&&(t<=0?this.removeItem(e):(r.quantity=t,this.saveCartToStorage(),this.updateCartDisplay()))}getCartTotal(){return this.cart.reduce((e,t)=>e+t.price*t.quantity,0)}getCartCount(){return this.cart.reduce((e,t)=>e+t.quantity,0)}updateCartDisplay(){const e=document.querySelectorAll("#cart-count"),t=document.querySelectorAll("#cart-total");e.forEach(r=>{r&&(r.textContent=this.getCartCount(),r.setAttribute("aria-label",`Carrello, ${this.getCartCount()} elementi`))}),t.forEach(r=>{r&&(r.textContent=this.getCartTotal().toFixed(2)+"€")})}announceToScreenReader(e){const t=document.createElement("div");t.setAttribute("aria-live","polite"),t.setAttribute("aria-atomic","true"),t.className="sr-only",t.textContent=e,document.body.appendChild(t),setTimeout(()=>{document.body.removeChild(t)},1e3)}getCartItems(){return this.cart}clearCart(){this.cart=[],this.saveCartToStorage(),this.updateCartDisplay()}}let s;document.addEventListener("DOMContentLoaded",function(){s=new l;const i=document.getElementById("mobile-menu-button"),e=document.getElementById("mobile-menu");i&&e&&i.addEventListener("click",function(){const r=e.classList.contains("hidden");e.classList.toggle("hidden"),i.setAttribute("aria-expanded",!r)}),document.querySelectorAll(".add-to-cart").forEach(r=>{r.addEventListener("click",function(){const a=this.dataset.pizzaId,o=this.dataset.pizzaName,n=parseFloat(this.dataset.pizzaPrice)||0;s.addItem(a,o,n),c(`${o} aggiunta al carrello!`)})}),document.querySelectorAll('a[href^="#"]').forEach(r=>{r.addEventListener("click",function(a){a.preventDefault();const o=document.querySelector(this.getAttribute("href"));o&&(o.scrollIntoView({behavior:"smooth",block:"start"}),o.tabIndex<0&&(o.tabIndex=-1),o.focus())})}),document.querySelectorAll("form").forEach(r=>{r.addEventListener("submit",function(a){d(r)||(a.preventDefault(),c("Per favore completa tutti i campi obbligatori","error"))})}),document.querySelectorAll(".category-filter").forEach(r=>{r.addEventListener("keydown",function(a){(a.key==="Enter"||a.key===" ")&&(a.preventDefault(),this.click())})})});function c(i,e="success"){const t=document.createElement("div");t.className=`fixed top-4 right-4 px-6 py-3 rounded-lg shadow-lg z-50 transition-opacity duration-300 ${e==="success"?"bg-green-500 text-white":"bg-red-500 text-white"}`,t.textContent=i,t.setAttribute("role","alert"),t.setAttribute("aria-live","assertive"),document.body.appendChild(t),setTimeout(()=>{t.style.opacity="0",setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t)},300)},5e3)}function d(i){const e=i.querySelectorAll("input[required], textarea[required], select[required]");let t=!0;const r=[];return e.forEach(a=>{if(a.classList.remove("border-red-500","ring-red-500"),a.value.trim()){const o=a.id+"-error",n=document.getElementById(o);n&&n.remove()}else{t=!1,r.push(a),a.classList.add("border-red-500");const o=a.id+"-error";let n=document.getElementById(o);n||(n=document.createElement("div"),n.id=o,n.className="text-red-500 text-sm mt-1",n.textContent="Questo campo è obbligatorio",n.setAttribute("aria-live","polite"),a.parentNode.insertBefore(n,a.nextSibling))}}),!t&&r.length>0&&r[0].focus(),t}function u(){const i=document.createElement("a");i.href="#main-content",i.textContent="Salta al contenuto principale",i.className="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 focus:z-50 focus:bg-white focus:text-black focus:p-4 focus:rounded",i.setAttribute("aria-label","Salta al contenuto principale"),document.body.insertBefore(i,document.body.firstChild)}document.addEventListener("DOMContentLoaded",u);
